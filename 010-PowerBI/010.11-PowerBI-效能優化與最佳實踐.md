---
title: 🧮 010.11-PowerBI-效能優化與最佳實踐
tags:
  - PowerBI
  - 效能優化
  - 資料模型
  - DAX
  - Power Query
aliases:
  - Power BI Performance
  - 最佳實踐
  - 效能調優
created: 2025-07-08
updated: 2025-07-08
status: 草稿
summary: 探討 Power BI 報表和資料模型效能優化的關鍵策略，包括資料載入、資料模型設計、DAX 公式優化和報表視覺化最佳實踐，以提升使用者體驗和報表響應速度。
---

## 🧮 為什麼 Power BI 效能優化如此重要？

想像一下，你精心製作了一個 Power BI 報表，但當同事打開時，它載入緩慢，點擊篩選器後遲遲沒有反應，這不僅影響了使用者體驗，也降低了報表的實用性。

**Power BI 效能優化** 的目標就是讓報表和資料模型運行得更快、更流暢。這對於大型數據集、複雜計算或高併發訪問的報表來說尤其關鍵。優化不僅能提升使用者滿意度，還能：

1.  **提高響應速度**：減少載入時間和互動延遲。
2.  **節省資源**：降低 Power BI 服務（或 Premium 容量）的資源消耗。
3.  **改善開發體驗**：更快的刷新速度和計算速度能加速開發與測試。
4.  **增強資料洞察**：流暢的互動讓用戶更願意探索數據，發現更多價值。

Power BI 的效能問題通常涉及三個主要階段：**資料載入與轉換**、**資料模型** 和 **報表與 DAX 計算**。因此，優化也需要從這三個層面全面考量。

---
## 🚀 階段一：資料載入與轉換 (Power Query) 優化

這是在資料進入 Power BI 模型前的第一道關卡。在這裡優化能從源頭減少不必要的數據量，從而為後續階段打下良好基礎。

1.  **只載入必要資料**：
    * **僅選擇所需欄位**：在 Power Query 編輯器中，移除所有報表和計算中不需要的欄位。每個欄位都會增加模型大小和處理時間。
    * **僅載入所需列**：利用 Power Query 的篩選功能，只載入時間範圍、業務類型或地區等篩選條件下的必要數據。
    * **聚合層級**：如果你的分析不需要每天的明細數據，可以在 Power Query 中進行聚合，將數據預先加總到更高的層級（例如按月或按產品類別）。

2.  **資料型別最佳化**：
    * **選擇最小的資料型別**：確保每個欄位都使用最精確且最小的資料型別。例如，如果數字不會有小數，使用整數 (Integer) 而非小數 (Decimal)。日期欄位使用 Date 型別而非 DateTime。
    * **偵測資料型別錯誤**：在 Power Query 中修正任何資料型別錯誤，避免在載入模型時因隱式轉換而產生效能問題。

3.  **減少查詢步驟**：
    * **利用查詢摺疊 (Query Folding)**：這是 Power Query 最重要的效能特性之一。盡可能讓 Power Query 將轉換操作推送到源資料庫執行（例如 SQL Server）。這樣，資料庫只會傳回已經過濾和轉換的結果，大大減少傳輸的數據量和 Power BI 的處理負擔。
    * 檢查每個步驟左上角的圖示，如果步驟旁有資料庫圖示，表示它支援查詢摺疊。某些操作（如合併不同來源、複雜的自訂函數）會中斷查詢摺疊。
    * **移除不必要的步驟**：刪除冗餘或重複的轉換步驟。

4.  **禁用自動日期/時間**：
    * 預設情況下，Power BI 會為每個日期/時間欄位創建隱藏的日期階層。禁用它，並手動建立一個**標準日期表**，能有效減少模型大小。
    * 禁用路徑：檔案 > 選項及設定 > 選項 > 目前檔案 > 資料載入 > **取消勾選**「時間智慧的自動日期/時間」。

---
## 🚀 階段二：資料模型 (Data Model) 優化

一個設計良好且高效的資料模型是 Power BI 報表效能的基石。

1.  **星型模式 (Star Schema)**：
    * **最佳實踐**：將你的資料模型設計成星型模式。它包含一個或多個**事實表 (Fact Tables)** 和多個**維度表 (Dimension Tables)**。
    * **事實表**：包含業務事件的度量值（如銷售金額、數量）和外鍵。
    * **維度表**：包含描述性屬性（如產品名稱、客戶名稱、日期）。
    * **優點**：星型模式減少了資料冗餘，簡化了 DAX 公式，並優化了查詢性能。

2.  **建立正確的關係**：
    * **確保關聯性正確**：使用唯一鍵建立正確的一對多 (One-to-Many) 或一對一 (One-to-One) 關係。避免循環關係。
    * **正確的基數 (Cardinality)**：確保關係的基數（一對一、一對多、多對一、多對多）與數據實際情況相符。
    * **正確的交叉篩選方向**：通常為單向篩選（從維度表篩選事實表）。雙向篩選 (Bidirectional Cross-filter) 雖然方便，但會增加複雜度和效能開銷，應謹慎使用。

3.  **隱藏不必要的欄位**：
    * 在模型檢視中，隱藏那些不會直接用於視覺化、切片器或報表頁面中的欄位（例如作為外鍵的 ID 欄位）。這有助於減少模型複雜度，並在欄位列表中提供更簡潔的視圖。

4.  **計算欄位與度量值的選擇**：
    * **優先使用度量值 (Measures)**：度量值是在報表查詢時動態計算的，不會增加模型大小。
    * **謹慎使用計算欄位 (Calculated Columns)**：計算欄位會增加資料模型的大小，因為它們的值會被儲存起來。除非計算欄位被用作切片器、視覺化軸或篩選器，否則盡量改用度量值。
    * **避免在計算欄位中使用昂貴的迭代操作**：例如在計算欄位中頻繁使用 `SUMX` 或 `FILTER`，可能會導致刷新時間過長。

---
### **💡 應用情境思考：**
如果一個銷售數據報表的載入速度很慢，經過檢查發現「產品表」和「客戶表」都是直接匯入大量原始資料，並且包含了許多與銷售分析無關的欄位。你會建議從資料載入和資料模型這兩個層面，各提出一個具體的優化建議嗎？

---

## 🚀 階段三：DAX 公式與報表視覺化優化

高效的 DAX 公式和精簡的報表設計是提升互動體驗的關鍵。

1.  **DAX 公式優化**：
    * **善用變數 (VAR)**：將複雜公式分解成多個步驟，每個變數只計算一次。這能提升可讀性，更重要的是**顯著提高效能**，避免重複計算。
    * **理解上下文轉換**：充分掌握 `CALCULATE` 函數及其觸發的上下文轉換。不必要的上下文轉換會降低效能。
    * **避免在篩選器中使用複雜表達式**：`CALCULATE` 函數中的篩選器應盡量簡潔高效。
    * **使用更高效的 DAX 函數**：例如，在某些情況下 `COUNTROWS(FILTER(...))` 可能不如 `COUNTX(FILTER(...))` 或 `CALCULATE(COUNTROWS(...), ...)` 高效。
    * **移除度量值中的隱式轉換**：確保參與計算的欄位有正確的資料型別。

2.  **報表視覺化最佳實踐**：
    * **限制視覺效果數量**：單一頁面上過多的視覺效果會增加查詢量和渲染時間。
    * **選擇合適的視覺效果**：某些視覺效果（如自訂視覺效果或包含大量資料點的地圖）可能比標準圖表更耗費資源。
    * **限制視覺效果中的資料點**：在視覺效果中避免顯示數十萬甚至數百萬的資料點，可以透過篩選或聚合來減少。
    * **使用頁面篩選器和報表層級篩選器**：適當地使用這些篩選器來限制視覺效果的數據量。
    * **最小化互動**：如果某些視覺效果之間不需要互動，可以禁用它們之間的互動，以減少不必要的交叉篩選查詢。
    * **移除不必要的視覺效果互動**：在「格式 > 編輯互動」中管理。

3.  **使用效能分析器 (Performance Analyzer)**：
    * **必備工具**：Power BI Desktop 中內建的「**效能分析器**」工具（位於「檢視」分頁）能幫助你找出報表中查詢最慢的視覺效果和 DAX 公式。
    * **分析查詢**：運行分析器後，你可以點擊每個視覺效果，查看它發送了哪些 DAX 查詢，以及這些查詢執行了多長時間。這對於精確定位效能瓶頸至關重要。

4.  **考慮增量刷新 (Incremental Refresh)**：
    * 對於非常大的事實表，啟用增量刷新可以大大減少資料刷新時間，因為它只載入和處理最近更新的數據。這需要在 Power BI Premium 容量或 Pro/Premium Per User 許可證下使用。


---
## 🔗 相關卡片

- [[010.2-PowerBI-資料匯入與轉換]] (Power Query 優化)
- [[010.3-PowerBI-資料模型與關聯]] (星型模式與關聯性)
- [[010.5-PowerBI-DAX 基礎語法]]
- [[010.5.a-PowerBI-DAX 變數應用 (VAR RETURN)]]
- [[010.9-PowerBI-DAX 進階計算與上下文轉換]] (DAX 公式優化)
- [[010.12-PowerBI-進階資料轉換與M語法]] (更深入的 Power Query 優化)

---