---
title: 🧮 010.13-PowerBI-資料安全與列層級安全性 (RLS)
tags:
  - PowerBI
  - 資料安全
  - RLS
  - 權限管理
  - 企業報表
aliases:
  - Power BI RLS
  - 列層級安全
  - 安全性模型
created: 2025-07-08
updated: 2025-07-08
status: 完成
summary: 深入探討 Power BI 中列層級安全性 (RLS) 的概念、工作原理、實作步驟，以及與資料安全和權限管理相關的最佳實踐，確保不同使用者只能看到他們被授權的資料子集。
---

## 🧮 什麼是列層級安全性 (RLS)？

想像你是一家跨國公司的銷售經理，需要給不同地區的銷售人員查看一份共同的銷售報表。你希望每個銷售人員都只能看到自己負責地區的銷售數據，而不能看到其他地區的數據。這時候，如果為每個地區都單獨建立一份報表，不僅效率低下，維護成本也極高。

這就是 **列層級安全性 (Row-Level Security, RLS)** 登場的時機！

**RLS** 是一種 Power BI 的資料安全機制，它允許你在**資料層面**限制使用者對特定資料列的存取。這意味著：

* 你可以為不同使用者或使用者群組定義不同的「**角色 (Roles)**」。
* 每個角色都會定義一套**篩選規則**，應用於資料模型中的特定表格。
* 當使用者查看報表時，Power BI 服務會根據使用者所屬的角色，**自動應用這些篩選規則**，確保使用者只能看到他們被授權的資料子集。

簡單來說，RLS 讓你可以維護**單一的 Power BI 報表和資料模型**，但呈現給不同用戶的數據卻是個性化且受限的。這大大簡化了報表的管理和分享，同時也保證了資料的安全性。

---
## 💡 RLS 的工作原理

RLS 的核心是透過**資料篩選器**來限制資料。當一個定義了 RLS 的 Power BI 報表被發佈到 Power BI 服務後，它的工作流程大致如下：

1.  **使用者登入 Power BI 服務**：用戶使用其 Microsoft Entra ID (Azure AD) 帳戶登入。
2.  **使用者請求報表**：用戶打開一個 Power BI 報表。
3.  **身份驗證與角色判斷**：Power BI 服務會驗證使用者的身份，並判斷該使用者所屬的 **RLS 角色**。
4.  **套用篩選上下文**：根據使用者所屬的 RLS 角色中定義的篩選規則，Power BI 服務會在**查詢模型資料時，自動將這些篩選條件應用到數據上**。
5.  **回傳篩選後的數據**：報表只會顯示經過 RLS 篩選後，使用者有權限看到的資料列。對於使用者沒有權限的資料列，它們將會被視為不存在，因此不會出現在任何視覺效果或計算中。

**RLS 的篩選是隱式的，且優先級高於報表中的其他篩選。** 無論用戶在報表上進行何種篩選操作，RLS 定義的篩選始終會先被應用。

---
## 🏗️ 如何實作列層級安全性 (RLS)？

在 Power BI Desktop 中實作 RLS 主要分為三個步驟：

### 步驟 1：在 Power BI Desktop 中建立角色 (Create Roles)

1.  開啟 Power BI Desktop 報表。
2.  在「模型 (Model)」檢視中，點擊上方的「**管理角色 (Manage Roles)**」按鈕（或在「模型」分頁下）。
3.  在「管理角色」視窗中，點擊「**建立 (Create)**」按鈕。
4.  為新角色命名，例如 `Sales_Region_North` 或 `Manager_Global`。
5.  在左側的「表格」列表中，展開你想要應用篩選的表格。
6.  在表格名稱右側，點擊三個點 `...`，然後選擇「**新增篩選 (Add filter)**」>「`<欄位名稱>`」。
    * **選擇關聯鍵欄位**：通常會選擇維度表中的地區、部門、國家、使用者 ID 等欄位來作為篩選依據。例如：`'地區表'[地區名稱]`。
7.  在彈出的 DAX 公式編輯器中，輸入篩選的 DAX 表達式。

    * **靜態篩選**：直接指定一個值。
        `'地區表'[地區名稱] = "北美洲"`
        這表示屬於此角色的用戶，只能看到地區名稱為「北美洲」的數據。

    * **動態篩選 (Dynamic RLS)**：利用 DAX 函數 `USERPRINCIPALNAME()` 或 `USERNAME()` 來獲取當前登入的用戶名，並將其與資料模型中的使用者 ID 欄位進行比對。
        `'員工表'[電子郵件] = USERPRINCIPALNAME()`
        這表示屬於此角色的用戶，只能看到「員工電子郵件」與其登入帳號相符的數據。動態 RLS 是更常用和高效的方式，因為它只需創建一個角色即可適用於所有用戶。

8.  對所有需要應用 RLS 的表格重複上述步驟。
9.  點擊「儲存 (Save)」關閉視窗。

### 步驟 2：在 Power BI Desktop 中驗證角色 (Validate Roles)

在發佈報表前，務必在 Desktop 中測試 RLS 是否按預期工作。

1.  在「模型 (Model)」檢視中，點擊「**檢視身分 (View as)**」按鈕。
2.  選擇你剛剛建立的角色（例如 `Sales_Region_North`）。
3.  或者，如果你使用了動態 RLS，可以選擇「**其他使用者 (Other user)**」並輸入一個用於測試的電子郵件地址（例如 `test@contoso.com`），這會模擬該用戶登入時的效果。
4.  報表會立即重新整理，只顯示該角色或用戶被授權的數據。
5.  檢查報表中的所有視覺效果和數字是否符合預期。
6.  點擊「停止檢視 (Stop Viewing)」以返回正常模式。

### 步驟 3：在 Power BI 服務中指派使用者/群組到角色 (Assign Users/Groups)

報表發佈到 Power BI 服務後，你需要將真實的使用者或使用者群組指派到這些角色。

1.  將報表發佈到 Power BI 服務。
2.  在 Power BI 服務中，找到你發佈的報表所在的**工作區 (Workspace)**。
3.  在報表旁邊，點擊三個點 `...`，選擇「**安全性 (Security)**」（或在資料集的選項中找到）。
4.  這會打開 RLS 介面。你會看到你在 Desktop 中建立的所有角色。
5.  點擊角色名稱旁邊的「**新增 (Add)**」或「**三點 (...)**」，輸入要指派給該角色的使用者電子郵件地址或 Microsoft Entra ID (Azure AD) 安全性群組名稱。
    * **推薦使用安全性群組**：這使得管理更加容易。你可以將多個用戶添加到一個組，然後將該組指派給一個角色。
6.  點擊「新增 (Add)」後，點擊「儲存 (Save)」。

---

### **小挑戰：思考時間！**

你是一家公司的 IT 管理員，你們有一個 Power BI 報表顯示了每個部門的預算使用情況。你希望部門主管只能看到自己部門的數據，而財務總監可以看到所有部門的數據。你會如何設計 RLS 角色和篩選規則來實現這個需求？

---
## ⚠️ RLS 的實務注意事項與限制

* **RLS 僅篩選數據**：RLS 只會篩選資料**列**，它不會隱藏視覺效果、頁面或任何其他報表元件。如果某個視覺效果由於 RLS 篩選而沒有數據，該視覺效果將顯示為空白或「沒有資料」。
* **不適用於所有資料來源**：RLS 最常用於匯入模式的資料集。對於 DirectQuery 模式，RLS 會將篩選條件推送到資料來源端。對於即時連線 (Live Connection) 模式，RLS 通常是在 SSAS 模型本身中定義的，而非 Power BI 報表。
* **安全性考量**：RLS 是一個資料篩選層，它**不是一個防彈牆**。如果使用者有足夠的權限直接存取基礎資料來源（例如直接連線到資料庫），他們仍然可以繞過 RLS。RLS 是在 Power BI 報表和服務層面的安全措施。
* **效能影響**：雖然 RLS 非常方便，但過於複雜的 RLS 規則或在大型資料模型上應用 RLS 可能會對查詢效能產生輕微影響。
* **測試的重要性**：始終在 Desktop 和服務中徹底測試你的 RLS 設定，確保其按預期工作，且沒有意外的數據洩露。
* **角色與群組管理**：在企業環境中，透過 Azure AD 安全性群組來管理 RLS 角色成員會比單獨指派用戶更有效率和可維護。

透過正確實作 RLS，你可以確保 Power BI 報表在被廣泛分享的同時，敏感的商業數據仍然受到嚴格的保護，只有被授權的人才能看到他們應該看到的資訊。

---
## 🔗 相關卡片

- [[010.7-PowerBI-發佈與分享報表]] (報表發佈後的管理)
- [[010.8-PowerBI-實戰案例：銷售儀表板]] (RLS 可作為此類報表的進階功能)
- [[010.11-PowerBI-效能優化與最佳實踐]] (複雜 RLS 可能對效能的影響)

---