---
title: 🧮 010.5-PowerBI-DAX 基礎語法
tags:
  - PowerBI
  - DAX
  - 資料分析
  - BI工具
aliases:
  - Power BI DAX
  - DAX 基礎
created: 2025-07-02
updated: 2025-07-02
status: 草稿
summary: 介紹 Power BI DAX 的基本概念、語法結構、常用函數與實用範例，協助建立自訂計算與進階分析能力。
---

## 🧮 什麼是 DAX？

- **DAX（Data Analysis Expressions）** 是 Power BI、Power Pivot、Analysis Services 專用的公式語言，用於建立自訂計算、度量值（Measure）、計算欄位與表格[1][3]。
- 可結合函數、運算子與常數，根據模型資料進行動態運算，產出新的洞察[1][3][4]。

---
## 📝 DAX 語法結構

- **公式開頭**：一律以等號 `=` 開始[1][4][5]。
- **名稱定義**：等號前為名稱（度量值、計算欄位或表名）[4][5]。
- **函數與運算子**：可多層嵌套，支援數學、邏輯、文字、日期等多種運算[1][2][4]。
- **欄位/表格參照**：
  - 表名用單引號 `'表名'`
  - 欄位用中括號 `[欄位名]`
  - 完整寫法如：`'銷售表'[金額]`[4]
- **變數宣告**：使用 `VAR` 定義變數，`RETURN` 回傳結果（提升效能與可讀性）[4]。

**範例：**
`總銷售額 = SUM('銷售表'[金額])`
`利潤率 = DIVIDE([利潤], [銷售額])`

---
## 🔑 常用 DAX 函數分類

| 類型           | 代表函數      | 說明與用途                       |
|:--------------|:-------------|:---------------------------------|
| 聚合          | SUM, AVERAGE, COUNT, MIN, MAX | 加總、平均、計數、最大最小值[1][2] |
| 篩選          | FILTER, CALCULATE, ALL        | 動態篩選資料、變更計算範圍[1][2]   |
| 邏輯          | IF, SWITCH, AND, OR           | 條件判斷、分支運算[2]             |
| 文字          | CONCATENATE, LEFT, RIGHT, SEARCH | 字串處理[2]                     |
| 日期/時間     | TODAY, YEAR, MONTH, DATEADD, SAMEPERIODLASTYEAR | 日期運算、期間比較[2]      |
| 變數          | VAR, RETURN                   | 宣告與重複引用變數[4]             |
| 計算表        | SUMX, COUNTX, VALUES          | 針對表格逐列運算[2]               |

---

## 🛠️ 常見 DAX 應用範例

- **建立度量值（Measure）**  
  用於報表即時計算，動態隨篩選器變動。
	`總銷售額 = SUM('銷售表'[金額])`

- **建立計算欄位**  
針對每一列計算，結果儲存在資料表中。
	 `庫存價值 = '產品表'[售價] * '產品表'[庫存量]`

- **條件判斷**  
	`銷售等級 = IF([總銷售額] > 100000, "高", "一般")`

- **動態篩選與進階計算** 
	`去年同期銷售 = CALCULATE([總銷售額], SAMEPERIODLASTYEAR('日期表'[日期]))`

- **變數運用**
	`銷售成長率 =`
	`VAR 去年 = CALCULATE([總銷售額], SAMEPERIODLASTYEAR('日期表'[日期]))`
	`VAR 今年 = [總銷售額]`
	`RETURN DIVIDE(今年 - 去年, 去年)`


---
## ⚠️ 實務注意事項

- **DAX 公式區分度量值與計算欄位，兩者計算時機與用途不同**[1][6]。
- **DAX 函數一律以欄位或表格為單位運算，無法直接引用單一儲存格**[1][4]。
- **複雜公式建議多用變數（VAR），提升可讀性與效能**[4]。
- **時間智慧函數需有正確的日期表，且日期欄位需連續無遺漏**[1][2]。

---
## 🔍 學習資源

- [Microsoft Learn：DAX 基本概念與語法說明][1][5]
- [DAX 函式參考總表][2]
- [30 分鐘學會 DAX 基本概念][3]
- [YouTube：DAX 實作教學][6]

---
## 🔗 相關卡片

- [[010.4-PowerBI-視覺化圖表應用]]
- [[010.6-PowerBI-互動功能與篩選器]]
- [[010.7-PowerBI-發佈與分享報表]]
