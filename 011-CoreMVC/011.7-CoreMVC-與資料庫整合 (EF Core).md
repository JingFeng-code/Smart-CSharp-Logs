---
title: ğŸ—„ï¸ 011.7-CoreMVC-èˆ‡è³‡æ–™åº«æ•´åˆ (EF Core)
tags:
  - ASP-NET
  - Core
  - MVC
  - EF
  - Core
  - è³‡æ–™åº«
  - ORM
aliases:
  - CoreMVC è³‡æ–™åº«
  - Entity Framework Core
created: 2025-07-02
updated: 2025-07-02
status: è‰ç¨¿
summary: ä»‹ç´¹ ASP.NET Core MVC èˆ‡ Entity Framework Core (EF Core) çš„æ•´åˆæµç¨‹ï¼Œæ¶µè“‹å®‰è£ã€è¨­å®šã€è³‡æ–™æ¨¡å‹è¨­è¨ˆã€DbContextã€è³‡æ–™åº«é·ç§»èˆ‡ CRUD æ“ä½œã€‚
---

## ğŸ—„ï¸ EF Core èˆ‡ ASP.NET Core MVC æ•´åˆæ¦‚è¿°

- **Entity Framework Core (EF Core)** æ˜¯ .NET çš„ç‰©ä»¶é—œè¯å°æ‡‰ï¼ˆORMï¼‰æ¡†æ¶ï¼Œæ”¯æ´ Code Firstã€Database First ç­‰é–‹ç™¼æ¨¡å¼ã€‚
- å¯è®“é–‹ç™¼è€…ä»¥ C# é¡åˆ¥æ“ä½œè³‡æ–™åº«ï¼Œç°¡åŒ–è³‡æ–™å­˜å–èˆ‡ç¶­è­·æµç¨‹ã€‚

---

## ğŸ› ï¸ æ•´åˆæ­¥é©Ÿèˆ‡åŸºæœ¬æµç¨‹

### 1. å®‰è£ EF Core å¥—ä»¶

- æ–¼ NuGet å¥—ä»¶ç®¡ç†å™¨æˆ– CLI å®‰è£ï¼š
	`Install-Package Microsoft.EntityFrameworkCore.SqlServer`
	`Install-Package Microsoft.EntityFrameworkCore.Tools`

- é¸æ“‡å°æ‡‰çš„è³‡æ–™åº«æä¾›è€…ï¼ˆå¦‚ SQL Serverã€MySQLã€PostgreSQL ç­‰ï¼‰[2][7]ã€‚

### 2. è¨­è¨ˆè³‡æ–™æ¨¡å‹ï¼ˆModelï¼‰

- åœ¨ `Models/` è³‡æ–™å¤¾å»ºç«‹è³‡æ–™é¡åˆ¥ï¼Œå°æ‡‰è³‡æ–™è¡¨æ¬„ä½ã€‚

```cshapr
public class Employee  
{  
	public int Id { get; set; }  
	public string Name { get; set; }  
	public string Designation { get; set; }  
}
```

- å¯åŠ ä¸Šè³‡æ–™è¨»è§£ï¼ˆData Annotationsï¼‰é€²è¡Œé©—è­‰ã€‚

### 3. å»ºç«‹ DbContext

- DbContext è² è²¬è³‡æ–™åº«é€£ç·šèˆ‡è³‡æ–™é›†ç®¡ç†ã€‚

```csharp
public class ApplicationDbContext : DbContext  
{  
	public ApplicationDbContext(DbContextOptions<ApplicationDbContext>Â options)
: base(options) { }

	public DbSet<Employee> Employees { get; set; }
}
```


### 4. è¨­å®šé€£ç·šå­—ä¸²

- åœ¨ `appsettings.json` åŠ å…¥é€£ç·šå­—ä¸²ï¼š

```csharp
"ConnectionStrings": {  
"DefaultConnection": "Server=localhost;Database=EmployeeDB;Trusted_Connection=True;"  
}
```


### 5. è¨»å†Š DbContext è‡³ DI å®¹å™¨

- æ–¼ `Program.cs` æˆ– `Startup.cs` çš„ `ConfigureServices` è¨»å†Šï¼š

```csharp
builder.Services.AddDbContext<ApplicationDbContext>(options =>  
options.UseSqlServer(builder.Configuration.GetConnectionString("DefaultConnection")));
```

- é€™æ¨£å³å¯æ–¼ Controller é€éå»ºæ§‹å‡½å¼æ³¨å…¥ DbContextã€‚

### 6. å»ºç«‹èˆ‡æ›´æ–°è³‡æ–™åº«ï¼ˆMigrationï¼‰

- ä½¿ç”¨ Migration ç®¡ç†è³‡æ–™åº«çµæ§‹ï¼š

```text
Add-Migration InitialCreate  
Update-Database
```

- Migration æœƒæ ¹æ“š Model ç”¢ç”Ÿ/æ›´æ–°è³‡æ–™è¡¨ã€‚

### 7. CRUD æ“ä½œç¯„ä¾‹

- **æ–°å¢è³‡æ–™**
```csharp
var employee = new Employee { Name = "John Doe", Designation = "Manager" };  
_context.Employees.Add(employee);  
_context.SaveChanges();
```

- **æŸ¥è©¢è³‡æ–™**

```csharp
var employees = _context.Employees.ToList();
```

- **æ›´æ–°è³‡æ–™**

```csharp
var employee = _context.Employees.FirstOrDefault(e => e.Id == 1);  
if (employee != null)  
{  
	employee.Name = "Jane Doe";  
	_context.SaveChanges();  
}
```

- **åˆªé™¤è³‡æ–™**

```csharp
var employee = _context.Employees.FirstOrDefault(e => e.Id == 1);  
if (employee != null)  
{  
	_context.Employees.Remove(employee);  
	_context.SaveChanges();  
}
```

---
## ğŸ—ï¸ å°ˆæ¡ˆçµæ§‹èˆ‡åˆ†å±¤å»ºè­°

- å»ºè­°å°‡è³‡æ–™å­˜å–å±¤ï¼ˆDbContextã€Repositoryï¼‰èˆ‡æ¥­å‹™é‚è¼¯å±¤åˆ†é›¢ï¼Œæå‡ç¶­è­·æ€§èˆ‡æ¸¬è©¦æ€§ã€‚
- å¯ä¾å¯¦å‹™éœ€æ±‚æ“´å…… Service Layerã€Repository Patternã€‚

---
## âš ï¸ å¸¸è¦‹å•é¡Œèˆ‡æ’æŸ¥

- **Migration å¤±æ•—**ï¼šç¢ºèªé€£ç·šå­—ä¸²æ­£ç¢ºã€è³‡æ–™åº«æ¬Šé™è¶³å¤ ã€‚
- **DbContext è¨»å†Šéºæ¼**ï¼šæœªè¨»å†Šå°‡å°è‡´ä¾è³´æ³¨å…¥éŒ¯èª¤ã€‚
- **è³‡æ–™æ¨¡å‹è®Šæ›´æœªåŒæ­¥**ï¼šéœ€é‡æ–°åŸ·è¡Œ Migration æ›´æ–°è³‡æ–™åº«çµæ§‹ã€‚
- **æ•ˆèƒ½å•é¡Œ**ï¼šæŸ¥è©¢æ™‚å¯å–„ç”¨ LINQã€åˆ†é ã€Include ç­‰æŠ€å·§ã€‚

---

## ğŸ” å»¶ä¼¸å­¸ç¿’è³‡æº

- [Microsoft Learnï¼šASP.NET Core MVC èˆ‡ EF Core æ•™å­¸]
- [iT é‚¦å¹«å¿™ï¼šEF Core å¯¦ä½œæ•™å­¸][6]
- [GitHub ç¯„ä¾‹å°ˆæ¡ˆ][5]

---

## ğŸ”— ç›¸é—œå¡ç‰‡

- [[011.6-CoreMVC-ä¾è³´æ³¨å…¥èˆ‡æœå‹™è¨»å†Š]]
- [[011.8-CoreMVC-åˆ†å±¤æ¶æ§‹èˆ‡å°ˆæ¡ˆå¯¦å‹™è¨­è¨ˆ]]
- [[007-LINQ-ç¸½è¦½]]
