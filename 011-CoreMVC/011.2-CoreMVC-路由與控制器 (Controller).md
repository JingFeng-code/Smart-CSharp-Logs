---
title: 🚦 011.2-CoreMVC-路由與控制器 (Controller)
tags:
  - ASP.NET Core
  - MVC
  - 路由
  - 控制器
  - 架構設計
aliases:
  - CoreMVC 路由
  - ASP.NET Core Controller
created: 2025-07-02
updated: 2025-07-02
status: 草稿
summary: 介紹 ASP.NET Core MVC 的路由機制、控制器設計原則、Action 方法與參數綁定，並涵蓋屬性路由與實務開發技巧。
---

## 🚦 路由（Routing）基礎

- **路由（Routing）** 是將 HTTP 請求 URL 映射到對應的控制器（Controller）與動作方法（Action）的機制。
- ASP.NET Core MVC 採用「屬性路由（Attribute Routing）」與「慣例路由（Conventional Routing）」兩種方式，可彈性組合使用。

### 慣例路由範例

- 在 `Program.cs` 或 `Startup.cs` 設定：
```csharp
app.UseEndpoints(endpoints =>  
{  
	endpoints.MapControllerRoute(  
	name: "default",  
	pattern: "{controller=Home}/{action=Index}/{id?}");  
});
```
- 支援自訂路徑、更彈性的 API 設計。

---
## 🧩 控制器（Controller）設計

- **控制器** 是負責處理 HTTP 請求、協調商業邏輯與回應 View 或資料的核心元件。
- 每個 Controller 類別通常繼承自 `Controller` 或 `ControllerBase`（API 專用）。

### Controller 範例

```csharp
public class ProductController : Controller  
{  
	// GET: /Product/Index  
public IActionResult Index()  
{  
	// 取得資料，傳遞給 View  
	return View();  
}

// GET: /Product/Details/5
public IActionResult Details(int id)
{
    // 根據 id 查詢產品
    return View();
}

// POST: /Product/Create
[HttpPost]
public IActionResult Create(Product model)
{
    if (ModelState.IsValid)
    {
        // 新增資料
        return RedirectToAction("Index");
    }
    return View(model);
}
```

---
## 📝 Action 方法與參數綁定

- **Action 方法**：Controller 內的公開方法，對應一個路由與 HTTP 動作（GET、POST、PUT、DELETE）。
- **參數綁定**：ASP.NET Core 會自動將 URL、QueryString、Form、Route 資料綁定到方法參數。
  - 基本型別自動綁定（如 int、string）
  - 複雜型別自動綁定表單資料到 Model

---
## 🛠️ 屬性路由與進階應用

- `[HttpGet]`、`[HttpPost]`、`[HttpPut]`、`[HttpDelete]`：明確指定 HTTP 動作。
- `[Route]` 支援路徑參數、可結合 Token（如 `[Route("Edit/{id:int}")]`）。
- `[FromQuery]`、`[FromRoute]`、`[FromForm]`、`[FromBody]`：明確指定資料來源，常用於 API。

---
## ⚠️ 常見問題與實務建議

- **路由衝突/覆蓋**：屬性路由與慣例路由混用時，需注意優先順序與唯一性。
- **Action 方法命名**：建議依 RESTful 標準命名（Index、Details、Create、Edit、Delete）。
- **參數驗證**：善用 ModelState 與資料註解確保資料正確性。
- **依賴注入**：Controller 可直接注入服務（Service），提升可測試性與維護性。

---
## 🔗 相關卡片

- [[011.1-CoreMVC-框架介紹與專案結構]]
- [[011.3-CoreMVC-模型設計與資料綁定 (Model)]]
- [[011.4-CoreMVC-視圖與 Razor 語法 (View)]]


