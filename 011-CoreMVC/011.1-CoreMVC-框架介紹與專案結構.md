---
title: 🏗️ 011.1-CoreMVC-框架介紹與專案結構
tags:
  - ASP-NET
  - Core
  - MVC
  - 專案結構
  - 架構設計
aliases:
  - CoreMVC 框架介紹
  - ASP.NET Core MVC 概念
created: 2025-07-02
updated: 2025-07-02
status: 草稿
summary: 介紹 ASP.NET Core MVC 的核心架構理念、MVC 設計模式與專案目錄結構，協助建立現代 .NET 後端開發的基礎認知。

---
學習 ASP.NET Core MVC 這個強大的 Web 框架，就像是準備要搭建一棟厲害的數位建築，而了解其「骨架」和「設計圖」是第一步，也是最重要的一步。

## 🏗️ ASP.NET Core MVC 框架簡介

* **跨平台建造**：程式碼可運行於 Windows、macOS 及 Linux 等多種作業系統，實現高度彈性。

* **模組化設計（MVC 模式）**：框架採用經典的 **MVC (Model-View-Controller) 設計模式**，將應用程式邏輯清晰地劃分為三大核心職責。這種分離模式極大地提升了開發效率、代碼可維護性與應用程式的擴展性。
	- **Model (模型)**：負責定義**資料結構**、處理**商業邏輯**、進行資料驗證與存取。它專注於回答「**是什麼**」以及「**資料該如何運作**」。
	- **View (視圖)**：專職於**使用者介面的呈現**。它的唯一職責是「**長什麼樣**」，將 Model 提供的資料以視覺化的方式展示給使用者。
	- **Controller (控制器)**：作為**請求的協調者**。它接收使用者請求、根據請求調用對應的 Model 處理資料，最終決定並回應適當的 View。其核心任務是處理「**怎麼做**」的流程控制。

* **支援現代技術**：ASP.NET Core MVC 內建並深度支援多項現代開發實踐，例如：
	- **RESTful API** 的快速構建。
	- 簡化頁面開發的 **Razor Pages**。
	- 提升應用程式可測試性和靈活性的**依賴注入 (Dependency Injection)**。
	- 可高度自訂請求處理流程的**模組化中介軟體 (Middleware)**。
	- 以及方便快捷的**單元測試**支援。

---
## 🧩 MVC 設計模式核心概念

![[aspnet-core-mvc-basic.jpg]]
MVC 設計模式的核心理念在於「**職責分離 (Separation of Concerns)**」。這種分離確保了每個組件都專注於自身的核心職責，從而大幅降低了模組間的耦合度。這對於專案的長期維護、功能擴展和單元測試都至關重要。

| 組件                  | 職責說明                                     | 簡化理解                        |
| :------------------ | :--------------------------------------- | :-------------------------- |
| **Model(模型)**       | 定義資料結構、商業邏輯、資料驗證與存取                      | 負責處理資料庫資料，應用程式的**數據與規則**核心。 |
| **View(檢視)**        | 呈現資料，負責 UI 顯示與前端互動，HTML、CSS、JavaScript 等 | 顯示應用程式的**使用者介面**。           |
| **Controller(控制器)** | 接收使用者請求、調用 Model 處理資料，並最終決定回應哪個 View。    | 負責流程控制、應用程式的**請求處理與協調者**。   |
|                     |                                          |                             |

**優點：** 
- **分工明確**：各組件職責清晰，極大化了團隊協作效率，並提升了程式碼的可讀性和可維護性。
- **易於維護與測試**：單一職責原則使得各部分可以獨立進行修改和測試，減少了模組間的相互影響，降低了引入錯誤的風險。
- **彈性與擴展性**：由於職責分離，您可以更輕鬆地替換或擴展前端技術（如更換不同的 JavaScript 框架）、後端資料來源或商業邏輯組件，使應用程式更具彈性以應對未來需求。。

---
### MVC 完整請求處理流程：從開始到結束
1. **使用者發出請求**：當使用者在瀏覽器中輸入 URL 或點擊連結時，瀏覽器會向伺服器發送一個 **HTTP Request** (例如 GET, POST)。
2. **路由機制**：ASP.NET Core MVC 的**路由 (Routing)** 中介軟體會攔截這個 Request。它根據預先定義的路由規則，解析 URL 並將 Request 精確地導向至對應的 **Controller** 及特定的 **Action Method**。
3. **控制器處理**：被路由到的 Action Method 接收 Request。它會判斷這個請求是否需要與 Model 進行互動（例如，從資料庫讀取資料或更新資料）。
4. **模型響應**：如果需要，Controller 會呼叫 **Model**。Model 執行所有必要的商業邏輯計算、資料驗證，並從資料庫或其他資料源獲取或更新資料，然後將處理結果或數據回傳給 Controller。
5. **視圖呈現**：Controller 接收到 Model 傳回的資料後，會將這些資料傳遞給指定的 **View**。View 則利用這些數據，結合 Razor 語法，生成最終的 HTML 內容。
6. **回應使用者**：生成的 HTML 內容被封裝成 **HTTP Response**，回傳給瀏覽器。使用者最終在瀏覽器中看到應用程式所呈現的頁面。

---
## 📁 ASP.NET Core MVC 專案目錄結構：標準化藍圖

建立 ASP.NET Core MVC 專案時，Visual Studio 或 `dotnet CLI` 會自動生成一個標準的專案骨架，規劃好各個功能區域：

```text
MyProject/
├── .vs/                 # Visual Studio 相關的隱藏設定和快取文件（非專案程式碼）
├── bin/                 # 編譯後的二進位檔案（執行檔、DLLs 等）
├── obj/                 # 編譯過程中的暫存檔案
├── Connected Services/  # 連接服務：Visual Studio 用於管理與外部服務（如 Azure 服務、資料庫）整合的組態和自動生成代碼。
├── Properties/          # 專案屬性：包含專案的設定檔，最重要的為 launchSettings.json，定義調試和啟動配置。
├── wwwroot/             # 靜態資源：存放可公開存取的靜態檔案，如 CSS 樣式表、JavaScript 檔案、圖片、字體等。
├── Dependencies/        # 相依性：在 Visual Studio 中呈現為節點，管理專案所有引用的 NuGet 套件、框架組件及專案參考。這是專案運行所需所有外部支援的「心臟」。
├── Controllers/         # 控制器：包含處理 HTTP 請求並返回響應的類別，是應用程式的請求處理入口。
├── Models/              # 資料模型：定義應用程式中資料的結構、資料驗證規則及部分商業邏輯。
├── Views/               # 視圖：包含用 Razor 語法編寫的 .cshtml 檔案，用於生成 HTML 響應。
├── Data/                # 資料存取層：通常建議自行建立此資料夾，用於存放 DbContext 類別和所有與資料庫操作相關的程式碼（例如 Repository 模式）。
├── Services/            # 業務邏輯服務層：通常建議自行建立此資料夾，用於處理複雜的商業邏輯，常透過依賴注入 (DI) 注入到 Controller 中。
├── Middleware/          # 自訂中介軟體：存放自訂的中介軟體類別，用於處理 HTTP 請求/回應管線中的自訂邏輯（例如身份驗證、日誌記錄、壓縮等）。
├── appsettings.json     # 應用程式組態檔：儲存應用程式運行時的各種設定，如資料庫連線字串、API Key 等。可以有 appsettings.Development.json 等多環境配置。
├── Program.cs           # 應用程式進入點：從 .NET 6 開始，此檔案負責應用程式的啟動配置，包括設定主機、服務註冊和 HTTP 請求處理管線。
├── MyProject.csproj     # 專案檔：XML 格式的專案設定檔，定義了專案的目標框架、引用、編譯選項等。
└── ...                  # 其他：可能還包括 Migrations (EF Core 資料庫遷移)、Resources (多語言資源)、Tests (測試專案) 等。
```

### 核心目錄與檔案說明：

- **`Dependencies/`**：這是專案的「**核心組件庫**」！它集合了專案所依賴的所有 **NuGet 套件**、**.NET Core 框架組件**以及**內部專案參考**。當您透過 NuGet 安裝任何第三方函式庫（例如 Entity Framework Core、各種 API 客戶端等），它們都會在這裡被管理，確保應用程式能夠順利運行所需的所有外部支援。

- **`Controllers/`**：這些類別是應用程式的「**指揮中心**」。它們負責接收 HTTP 請求，根據請求邏輯調用相應的模型，並最終決定返回哪個視圖或數據。

- **`Models/`**：定義應用程式中**資料的結構與行為**。這包括資料庫實體、驗證規則以及與資料操作相關的部分商業邏輯。

- **`Views/`**：包含用 **Razor 語法**（一種將 C# 代碼嵌入 HTML 的模板引擎）編寫的 `.cshtml` 檔案。它們負責根據 Controller 提供的數據來生成最終的 HTML 響應，是**使用者直接看到的介面**。

- **`wwwroot/`**：這個資料夾是應用程式的「**公開區域**」。所有公共的靜態資源，例如 **CSS 樣式表**、**JavaScript 檔案**、**圖像**和**字體**等，都存放於此，可以直接被瀏覽器存取。

- **`Data/` 和 `Services/`**：這兩個資料夾是**強烈推薦您自行建立**的，以實踐更清晰的**分層架構**。
	- `Data/` 負責所有**資料庫互動**的邏輯，例如存放 `DbContext` 和實現各種 Repository 模式。
	- `Services/` 負責處理應用程式的**核心業務邏輯**，將複雜的商業規則從 Controller 中分離出來，通常會透過依賴注入 (DI) 的方式被 Controller 調用。

- **`Middleware/`**：用於存放您自訂的**中介軟體**。中介軟體是構成 ASP.NET Core 請求處理管線的核心組件，可以攔截並處理進入的 HTTP 請求和返回的 HTTP 回應，例如身份驗證、日誌記錄、錯誤處理等。

- **`Connected Services/`**：這是 Visual Studio 提供的一個便利功能，用於**簡化與外部雲端服務的整合**。例如，當您連接 Azure SQL Database、Azure Storage 或其他 Web 服務時，它會自動生成相關的配置和必要的程式碼，大大簡化了開發流程。

- **`Properties/`**：這個資料夾包含了專案的**設定檔案**，其中最常用的是 `launchSettings.json`。這個 JSON 檔案定義了在開發環境下啟動應用程式的方式，例如不同的啟動設定檔、使用的環境變數、以及本地開發伺服器的 URL 等。

- **`appsettings.json`**：這是應用程式的**主要組態檔**。它以 JSON 格式儲存了應用程式運行時的各種設定，如資料庫連線字串、第三方 API 金鑰、應用程式行為設定等。通常還會有 `appsettings.Development.json` 和 `appsettings.Production.json` 等多環境配置檔。

- **`Program.cs`**：從 **.NET 6** 開始，這個檔案成為應用程式的**統一啟動配置中心**。它負責設定主機、註冊應用程式所需的服務（如 MVC 服務、資料庫服務等），並配置 HTTP 請求處理管線中的中介軟體。

- **`MyProject.csproj`**：這是專案的**核心定義檔**（XML 格式）。它定義了專案的目標框架、所有引用的 NuGet 套件、檔案的包含/排除規則、編譯選項以及其他專案相關的元數據。

---
## 🛠️ 專案初始化與開發流程：從零開始打造

啟動您的 ASP.NET Core MVC 專案，並開始高效開發的過程：

1. **建立專案**
    
    - **使用 .NET CLI**：在命令列輸入 `dotnet new mvc -n MyProject`，即可快速建立一個基礎的 MVC 專案。
        
    - **透過 Visual Studio**：在 Visual Studio 中，選擇「建立新專案」，然後選擇「ASP.NET Core Web 應用程式 (Model-View-Controller)」範本。
        
2. **專案結構優化**
    
    - 根據您的專案規模和需求，建議自行新增如 `Data`、`Services`、`ViewModels` 等資料夾，這有助於更好地組織和管理程式碼，提升可讀性和可維護性。

    - 配置 `appsettings.json` 以管理應用程式的設定和環境變數，這讓您的應用程式配置更具彈性，方便在不同環境中部署。

3. **高效開發流程建議**
    
    - **優先設計 Model**：在實際開發中，通常建議從 Model 開始設計。先定義好資料結構、資料庫關係和基本的商業規則，這將是整個應用程式的基石。良好的模型設計能事半功倍。
    
    - **接著撰寫 Controller 與 View**：基於設計好的 Model，開始撰寫 Controller 來處理請求，並設計 View 來呈現資料。確保前後端的邏輯和介面協調一致。
    
    - **善用依賴注入 (DI)**：積極實踐 DI，這會使您的程式碼更加**鬆耦合**，大幅提升程式碼的**彈性**、**可測試性**和**可維護性**，是現代 ASP.NET Core 開發的核心實踐。
    
    - **實踐分層設計**：將程式碼邏輯劃分為清晰的不同層次（例如：表示層、業務邏輯層、資料存取層）。這對於大型專案的協作、維護與擴展至關重要，能有效降低複雜度。

---
## ⚠️ 常見問題與實務開發建議

- **專案結構的彈性**：儘管存在標準化的專案結構慣例，但實際專案結構可以根據您的團隊協作模式、專案規模和特定需求靈活調整。找到最適合您的組織方式才是最重要的。

- **.NET 6 的變革**：請特別留意，從 **.NET 6** 開始，原本分散在 `Startup.cs` 和 `Program.cs` 的功能已經**完全整合到 `Program.cs`** 單一檔案中。這使得專案的啟動配置程式碼更為精簡和集中。

- **資料夾命名多樣性**：除了基礎的 MVC 目錄外，您可以根據職責細分更多資料夾，例如：
    - `ViewModels`：專為 View 設計的資料模型。
    - `DTOs` (Data Transfer Objects)：用於跨層或跨服務傳輸資料的對象。
    - `Repositories`：實現資料倉儲模式，抽象化資料存取邏輯。
    - `Helpers`：存放輔助性工具方法。
    - 這種細分有助於提高程式碼的組織性和可維護性。

- **Razor Pages 的選擇**：對於頁面導向、較簡單的功能模組，或者不需要完整 MVC 模式複雜度的場景，**Razor Pages** 是 ASP.NET Core 提供的另一種簡潔且強大的選項。它與 MVC 可以在同一個專案中並存，您可以根據具體功能需求靈活選擇。

---
## 🔗 相關卡片

- [[011.2-CoreMVC-路由與控制器 (Controller)]]
- [[011.3-CoreMVC-模型設計與資料綁定 (Model)]]
- [[011.4-CoreMVC-視圖與 Razor 語法 (View)]]


