---
title: 🗃️ 011.3-CoreMVC-模型設計與資料綁定 (Model)
tags:
  - ASP.NET Core
  - MVC
  - Model
  - 資料綁定
  - 資料驗證
aliases:
  - CoreMVC Model
  - ASP.NET Core 資料綁定
created: 2025-07-02
updated: 2025-07-02
status: 草稿
summary: 介紹 ASP.NET Core MVC 的模型設計原則、資料綁定與驗證機制，包含 Model、ViewModel、資料註解與實務應用技巧。
---

## 🗃️ Model（模型）基礎

- **Model** 是 MVC 架構中負責資料結構、商業邏輯與資料驗證的核心元件。
- 常見類型：
  - **資料模型（Entity/Domain Model）**：對應資料庫實體，用於資料存取與商業邏輯。
  - **ViewModel**：專為 View 設計的資料結構，僅包含頁面所需欄位，避免暴露多餘資料。

---
## 🛠️ Model 設計範例

```csharp
public class Product  
{  
	public int Id { get; set; }
	[Required]
	[StringLength(100)]
	public string Name { get; set; }

	[Range(0, 99999)]
	public decimal Price { get; set; }

	public DateTime CreatedAt { get; set; }
}
```
- 使用 **資料註解（Data Annotations）** 進行欄位驗證（如 `[Required]`、`[StringLength]`、`[Range]`）。

---
## 🔄 資料綁定（Model Binding）

- ASP.NET Core 會自動將 HTTP 請求中的資料（URL、QueryString、Form、Route、JSON）綁定到 Action 方法參數或 Model。
- 支援基本型別、複雜型別與集合型別自動綁定。

### 常見綁定來源

| 資料來源     | 屬性            | 範例用法                          |
|:------------|:---------------|:----------------------------------|
| 路由        | [FromRoute]     | `public IActionResult Edit([FromRoute]int id)` |
| 查詢字串    | [FromQuery]     | `public IActionResult List([FromQuery]string keyword)` |
| 表單        | [FromForm]      | `public IActionResult Create([FromForm]Product model)` |
| JSON Body   | [FromBody]      | `public IActionResult Api([FromBody]Product model)`    |

- 一般 MVC 預設會自動綁定表單與路由資料，API 常需明確標註來源。

---
## ✅ 資料驗證（Model Validation）

- **ModelState** 物件可用於檢查資料驗證結果，常見於表單送出後：

```csharp
[HttpPost]  
public IActionResult Create(Product model)  
{  
	if (ModelState.IsValid)  
{  
// 資料通過驗證，執行後續邏輯  
}  
	return View(model);  
}
```

- 支援自訂驗證屬性（繼承 `ValidationAttribute`），或於 View 顯示驗證訊息。

---
## 📝 ViewModel 設計與應用

- **ViewModel** 用於複雜表單、跨多個 Model 的畫面資料整合，提升安全性與彈性。
- 可搭配 AutoMapper 等工具進行 Model 與 ViewModel 之間的轉換。

```csharp
public class ProductEditViewModel  
{  
	public int Id { get; set; }  
	public string Name { get; set; }  
	public decimal Price { get; set; }  
	public string CategoryName { get; set; }  
}
```


---
## ⚠️ 常見問題與建議

- **避免在 View 直接使用資料庫實體**，建議使用 ViewModel 隔離。
- **資料驗證盡量於 Model 層處理**，減少重複邏輯。
- **複雜驗證可自訂屬性或於 Service 層處理**。
- **Model Binding 支援多語系錯誤訊息**，可自訂資源檔。

---
## 🔗 相關卡片

- [[011.2-CoreMVC-路由與控制器 (Controller)]]
- [[011.4-CoreMVC-視圖與 Razor 語法 (View)]]
- [[011.5-CoreMVC-表單處理與驗證]]


