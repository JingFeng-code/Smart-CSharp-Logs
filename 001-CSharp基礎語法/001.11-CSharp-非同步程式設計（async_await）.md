---
title: ğŸ§µ 001.11-CSharp-éåŒæ­¥ç¨‹å¼è¨­è¨ˆï¼ˆasync_awaitï¼‰  
tags:
- C#
- éåŒæ­¥ç¨‹å¼è¨­è¨ˆ
- async
- await
- Task
- ä¸¦è¡Œè™•ç†  
aliases:
- C# éåŒæ­¥æ•™å­¸
- C# async await
- C# å¤šå·¥è™•ç†  
created: 2025-07-24  
updated: 2025-07-24  
status: è‰ç¨¿  
summary: æœ¬ç¯‡ç­†è¨˜ä»‹ç´¹ C# ä¸­çš„éåŒæ­¥ç¨‹å¼è¨­è¨ˆï¼Œèªªæ˜ `async/await` çš„åŸºæœ¬èªæ³•ã€æ‡‰ç”¨å ´æ™¯èˆ‡å¸¸è¦‹éŒ¯èª¤ï¼Œå¹«åŠ©ä½ å¯«å‡ºä¸å¡ UIã€ä¸é˜»å¡ä¸»åŸ·è¡Œç·’çš„ç¾ä»£åŒ–ç¨‹å¼ç¢¼ï¼Œæ˜¯æ’°å¯« Web APIã€æ¡Œé¢æ‡‰ç”¨èˆ‡ä¸²æ¥è³‡æ–™åº«æ™‚ä¸å¯æˆ–ç¼ºçš„æŠ€èƒ½ã€‚
---

## ğŸ“˜ æœ¬ç¯‡é‡é»ç´¢å¼•

- éåŒæ­¥ç¨‹å¼è¨­è¨ˆæ˜¯ä»€éº¼ï¼Ÿç‚ºä»€éº¼é‡è¦ï¼Ÿ

- `async` èˆ‡ `await` çš„èªæ³•èˆ‡ä½¿ç”¨è¦å‰‡

- Task çš„åŸºæœ¬æ¦‚å¿µèˆ‡å¸¸è¦‹ç”¨é€”

- ç¯„ä¾‹ï¼šéåŒæ­¥å‘¼å« API / ç­‰å¾…è³‡æ–™åº«æŸ¥è©¢

- å¸¸è¦‹éŒ¯èª¤èˆ‡é™¤éŒ¯æŠ€å·§

---
## 1ï¸âƒ£ ç‚ºä»€éº¼è¦å­¸ã€ŒéåŒæ­¥ã€ï¼Ÿ

### å‚³çµ±åŒæ­¥ç¨‹å¼æœƒé˜»å¡ä¸»åŸ·è¡Œç·’ï¼š
```csharp
Thread.Sleep(5000); // å¡ä½5ç§’ï¼ŒUIç„¡å›æ‡‰
```

### ä½¿ç”¨éåŒæ­¥å¯ä»¥ï¼š

âœ… æé«˜ç³»çµ±åæ‡‰é€Ÿåº¦  
âœ… ä¸é˜»å¡ UI æˆ–ä¸»æµç¨‹  
âœ… æ”¯æ´ I/O å¯†é›†å·¥ä½œï¼ˆä¾‹å¦‚ï¼šæª”æ¡ˆã€APIã€DBï¼‰

---
## 2ï¸âƒ£ async èˆ‡ await èªæ³•èªªæ˜

```csharp
public async Task MyMethodAsync()
{
    // æ¨¡æ“¬éåŒæ­¥å·¥ä½œ
    await Task.Delay(3000); 
    Console.WriteLine("å·¥ä½œå®Œæˆï¼");
}
```

- `async`ï¼šæ¨™ç¤ºé€™æ˜¯ä¸€å€‹ã€ŒéåŒæ­¥æ–¹æ³•ã€
- `await`ï¼šç­‰å¾…éåŒæ­¥å·¥ä½œçš„å®Œæˆï¼Œä¸æœƒé˜»å¡åŸ·è¡Œç·’
- å›å‚³å‹åˆ¥é€šå¸¸æ˜¯ `Task` æˆ– `Task<T>`

ğŸ“Œ **æ³¨æ„ï¼šä¸èƒ½ç”¨ `void`ï¼Œé™¤éæ˜¯äº‹ä»¶è™•ç†å™¨ï¼**

---
## 3ï¸âƒ£ Task èˆ‡ Task<`T`> æ˜¯ä»€éº¼ï¼Ÿ

- `Task`ï¼šè¡¨ç¤ºä¸€å€‹é€²è¡Œä¸­çš„å·¥ä½œï¼ˆç„¡å›å‚³å€¼ï¼‰

```csharp
public async Task SaveFileAsync() { ... }
```

- `Task<T>`ï¼šè¡¨ç¤ºä¸€å€‹å¸¶æœ‰å›å‚³å€¼çš„å·¥ä½œ

```csharp
public async Task<string> GetDataAsync()
{
    await Task.Delay(1000);
    return "å–å¾—çš„è³‡æ–™";
}
```

---
## 4ï¸âƒ£ ç¯„ä¾‹ï¼šéåŒæ­¥å‘¼å« API

```csharp
public async Task<string> GetUserDataAsync()
{
    using var http = new HttpClient();
    var response = await http.GetStringAsync("https://jsonplaceholder.typicode.com/users/1");
    return response;
}
```

âœ… ä½¿ç”¨ `HttpClient` é…åˆ `await` ç­‰å¾… API å›å‚³  
âœ… ä¸æœƒå¡ä½ç•«é¢ï¼Œä¹Ÿä¸éœ€è¦ Thread.Sleepï¼

---
## 5ï¸âƒ£ éåŒæ­¥èˆ‡ UI çš„æ•´åˆï¼ˆWinForms / WPFï¼‰

```csharp
private async void btnDownload_Click(object sender, EventArgs e)
{
    btnDownload.Enabled = false;
    var data = await GetUserDataAsync();
    txtResult.Text = data;
    btnDownload.Enabled = true;
}
```

ğŸ“Œ `async void` é©ç”¨æ–¼äº‹ä»¶è™•ç†å™¨

---
## 6ï¸âƒ£ å¸¸è¦‹éŒ¯èª¤æ’æŸ¥

| éŒ¯èª¤è¨Šæ¯ / è¡Œç‚º                    | åŸå› èˆ‡è§£æ³•                      |
| ---------------------------- | -------------------------- |
| `await` å¿…é ˆåœ¨ `async` æ–¹æ³•ä¸­ä½¿ç”¨    | æ–¹æ³•éœ€åŠ ä¸Š `async` ä¿®é£¾è©          |
| æ–¹æ³•æ²’æœ‰å›å‚³ `Task` å»ä½¿ç”¨ `await`    | ç¢ºä¿å›å‚³å‹åˆ¥ç‚º `Task` æˆ– `Task<T>` |
| UI ç•¶æ‰æ²’åæ‡‰                     | ä½¿ç”¨äº†åŒæ­¥æ–¹æ³•ï¼Œæ”¹ç”¨ `await` éåŒæ­¥ç‰ˆæœ¬   |
| `ConfigureAwait(false)` æ˜¯ä»€éº¼ï¼Ÿ | è‹¥ä¸éœ€å› UI åŸ·è¡Œç·’ï¼Œå¯ä½¿ç”¨ä¾†æ”¹å–„æ•ˆèƒ½       |
|                              |                            |

---
## âœ… å°çµ

- ä½¿ç”¨ `async/await` æ˜¯ C# éåŒæ­¥ç¨‹å¼çš„æ¨™æº–å¯«æ³•

- å¯é¿å…å¡ UIã€æå‡æ•ˆèƒ½èˆ‡ä½¿ç”¨è€…é«”é©—

- ç†Ÿæ‚‰ `Task`, `Task<T>` æ˜¯å…¥é–€é—œéµ

- éåŒæ­¥é©ç”¨æ–¼ API å‘¼å«ã€DB æŸ¥è©¢ã€æª”æ¡ˆè™•ç†ç­‰æƒ…å¢ƒ

- WinForms/WPF ä¸­åªèƒ½åœ¨äº‹ä»¶è™•ç†å™¨ä½¿ç”¨ `async void`

---

## ğŸ”— å»¶ä¼¸é–±è®€

- [[001.8-CSharp-æ–¹æ³•èˆ‡åƒæ•¸]]
- [[001.10-CSharp-éŒ¯èª¤ä¾‹å¤–è™•ç†]]
- [Microsoft éåŒæ­¥ç¨‹å¼è¨­è¨ˆå®˜æ–¹æ–‡ä»¶](https://learn.microsoft.com/zh-tw/dotnet/csharp/asynchronous-programming/)
- [C# Task vs Thread å·®ç•°](https://learn.microsoft.com/zh-tw/dotnet/standard/threading/)