---
title: ğŸ”— 015.14-Angular-èˆ‡ ASP.NET Core API ä¸²æ¥æ•´åˆ  
tags:
- Angular 
- ASP.NET Core 
- APIä¸²æ¥
- å‰å¾Œç«¯æ•´åˆ
- RESTful API  
aliases:
- Angular ä¸²æ¥å¾Œç«¯
- Angular å‘¼å« ASP.NET API  
- Angular Web API æ•´åˆ  
created: 2025-07-23  
updated: 2025-07-23  
status: è‰ç¨¿  
summary: æœ¬ç¯‡ç­†è¨˜æ•™å­¸å¦‚ä½•å°‡ Angular å‰ç«¯èˆ‡ ASP.NET Core Web API ä¸²æ¥æ•´åˆï¼Œèªªæ˜ HTTP Client ä½¿ç”¨æ–¹å¼ã€CORS è¨­å®šã€Token æˆæ¬Šè™•ç†ã€API éŒ¯èª¤è™•ç†èˆ‡è³‡æ–™äº¤æ›æµç¨‹ï¼Œå»ºç«‹å‰å¾Œç«¯å®Œæ•´æºé€šæ©Ÿåˆ¶ã€‚
---

## ğŸ“˜ æœ¬ç¯‡é‡é»ç´¢å¼•

- è¨­è¨ˆå‰å¾Œç«¯åˆ†é›¢æ¶æ§‹ç°¡ä»‹

- Angular ä½¿ç”¨ HTTPClient å‘¼å« ASP.NET Core API

- ASP.NET Core API å»ºç«‹èˆ‡æ¸¬è©¦

- è™•ç† CORSï¼ˆè·¨ä¾†æºï¼‰å•é¡Œ

- å¸¶å…¥ JWT Token é€²è¡Œæˆæ¬Š

- è³‡æ–™äº¤æ›ç¯„ä¾‹èˆ‡éŒ¯èª¤è™•ç†

---

## 1ï¸âƒ£ å‰å¾Œç«¯åˆ†é›¢æ¶æ§‹ç°¡ä»‹

- Angular è² è²¬å‰ç«¯ UI é¡¯ç¤ºèˆ‡äº’å‹•

- ASP.NET Core API æä¾›è³‡æ–™è®€å¯«çš„å¾Œç«¯æœå‹™

- å…©è€…é€é HTTPï¼ˆé€šå¸¸æ˜¯ RESTfulï¼‰é€²è¡Œè³‡æ–™äº¤æ›

ğŸ“¦ Angular â†’ é€é `HttpClient` ç™¼é€è«‹æ±‚  
ğŸ“¦ ASP.NET Core â†’ æ¥æ”¶è«‹æ±‚ä¸¦å›æ‡‰è³‡æ–™ï¼ˆJSON æ ¼å¼ç‚ºä¸»ï¼‰

---
## 2ï¸âƒ£ Angular å‘¼å« API çš„åŸºæœ¬å¯«æ³•

```typescript
@Injectable({ providedIn: 'root' })
export class ProductService {
  private apiUrl = 'https://localhost:5001/api/products';

  constructor(private http: HttpClient) {}

  getProducts(): Observable<Product[]> {
    return this.http.get<Product[]>(this.apiUrl);
  }

  createProduct(product: Product): Observable<any> {
    return this.http.post(this.apiUrl, product);
  }
}
```

åœ¨ Component ä½¿ç”¨ï¼š

```typescript
this.productService.getProducts().subscribe(data => {
  this.products = data;
});
```

---
## 3ï¸âƒ£ ASP.NET Core å»ºç«‹ç°¡å–® Web API

ğŸ“ Controller ç¯„ä¾‹ï¼š

```csharp
[ApiController]
[Route("api/[controller]")]
public class ProductsController : ControllerBase
{
    [HttpGet]
    public IActionResult Get() => Ok(new[] {
        new { Id = 1, Name = "å•†å“ A" },
        new { Id = 2, Name = "å•†å“ B" }
    });

    [HttpPost]
    public IActionResult Create([FromBody] Product product)
    {
        // å¯¦éš›æ‡‰åŠ å…¥è³‡æ–™åº«è™•ç†
        return Ok(new { message = "æˆåŠŸå»ºç«‹", data = product });
    }
}
```

---
## 4ï¸âƒ£ è™•ç† CORS å•é¡Œ

ç•¶ Angular èˆ‡ ASP.NET Core åˆ†é–‹éƒ¨ç½²æ™‚ï¼ˆä¸åŒç¶²åŸŸæˆ– portï¼‰ï¼Œéœ€è¦è¨­å®š CORS æ‰èƒ½è®“å‰ç«¯å­˜å– APIã€‚

ğŸ“ ASP.NET Core `Program.cs` è¨­å®šï¼š

```csharp
builder.Services.AddCors(options =>
{
    options.AddPolicy("AllowAngularClient", policy =>
    {
        policy.WithOrigins("http://localhost:4200")
              .AllowAnyHeader()
              .AllowAnyMethod();
    });
});

app.UseCors("AllowAngularClient");
```

---
## 5ï¸âƒ£ å¸¶å…¥ JWT Token é€²è¡Œæˆæ¬Š

å‰ç«¯ Angular é€éæ””æˆªå™¨åŠ ä¸Š Authorization æ¨™é ­ï¼š

```typescript
intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {
  const token = this.authService.getToken();
  if (token) {
    req = req.clone({
      setHeaders: { Authorization: `Bearer ${token}` }
    });
  }
  return next.handle(req);
}
```

å¾Œç«¯éœ€é©—è­‰ JWTï¼š

```csharp
builder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)
    .AddJwtBearer(options => {
        options.TokenValidationParameters = new TokenValidationParameters
        {
            // è¨­å®šé‡‘é‘°èˆ‡é©—è­‰åƒæ•¸
        };
    });

app.UseAuthentication();
app.UseAuthorization();
```

---
## 6ï¸âƒ£ API éŒ¯èª¤è™•ç†èˆ‡è³‡æ–™æ ¼å¼ä¸€è‡´æ€§

å»ºè­° API å›å‚³æ¨™æº–æ ¼å¼ï¼š

```json
{
  "success": true,
  "data": { },
  "error": null
}
```

å‰ç«¯å¯æ ¹æ“š `success` é€²è¡Œ UI é¡¯ç¤ºï¼Œä¸¦çµ±ä¸€è™•ç†éŒ¯èª¤ï¼š

```typescript
this.http.get(...).subscribe({
  next: res => { if (res.success) { ... } },
  error: err => { this.handleError(err); }
});
```

---
## âœ… å°çµ

- Angular èˆ‡ ASP.NET Core API ä¸²æ¥å¸¸è¦‹æ–¼ä¼æ¥­ç´šæ‡‰ç”¨

- è«‹æ±‚/å›æ‡‰æ ¼å¼å»ºè­°çµ±ä¸€ç‚º JSONï¼Œæ–¹ä¾¿è™•ç†

- æ³¨æ„ CORS å•é¡Œèˆ‡ Token é©—è­‰æµç¨‹

- å¯ä»¥é€²ä¸€æ­¥åŠ å…¥è§’è‰²æ¬Šé™ã€API éŒ¯èª¤æ””æˆªç­‰æœ€ä½³å¯¦å‹™

---
## ğŸ”— å»¶ä¼¸é–±è®€

- [[012-RESTfulAPI-ç¸½è¦½]]
- [[015.13-Angular-èº«ä»½é©—è­‰(Authentication)èˆ‡æˆæ¬Š(Authorization)]]
- [ ASP.NET Core å®˜æ–¹æ•™å­¸](https://learn.microsoft.com/zh-tw/aspnet/core/web-api/?view=aspnetcore-9.0)
- [Angular HTTPClient æŒ‡å—](https://v17.angular.io/guide/understanding-communicating-with-http)
