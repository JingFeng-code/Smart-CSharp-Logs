---
title: ğŸ” 015.13-Angular-èº«ä»½é©—è­‰(Authentication)èˆ‡æˆæ¬Š(Authorization)  
tags:
- Angular
- Authentication
- Authorization
- JWT
- è·¯ç”±å®ˆè¡›  
aliases:
- Angular èº«ä»½é©—è­‰
- Angular æˆæ¬Šç®¡ç† 
- Angular JWT ç™»å…¥  
created: 2025-07-23  
updated: 2025-07-23  
status: è‰ç¨¿  
summary: æœ¬ç¯‡ç­†è¨˜ä»‹ç´¹å¦‚ä½•åœ¨ Angular ä¸­å¯¦ä½œèº«ä»½é©—è­‰èˆ‡æˆæ¬Šæ§åˆ¶ï¼ŒåŒ…å« JWT é©—è­‰æ©Ÿåˆ¶ã€ç™»å…¥æµç¨‹ã€Token å„²å­˜èˆ‡æ””æˆªã€è·¯ç”±å®ˆè¡› (Route Guard) ä»¥åŠåŸºæœ¬çš„ä½¿ç”¨è€…æ¬Šé™ç®¡ç†ã€‚
---

## ğŸ“˜ æœ¬ç¯‡é‡é»ç´¢å¼•

- Angular èº«ä»½é©—è­‰ vs æˆæ¬Šå·®ç•°

- JWT é©—è­‰æ©Ÿåˆ¶æµç¨‹

- ç™»å…¥èˆ‡å„²å­˜ Token å¯¦ä½œ

- å»ºç«‹ AuthService ç®¡ç†é©—è­‰é‚è¼¯

- ä½¿ç”¨ Route Guard æ§åˆ¶å­˜å–æ¬Šé™

- æ””æˆªå™¨æ””æˆª HTTP è«‹æ±‚åŠ ä¸Š Token

- å¯¦å‹™ä¸Šçš„å®‰å…¨æ€§å»ºè­°

---

## 1ï¸âƒ£ èº«ä»½é©—è­‰ vs æˆæ¬Šæ˜¯ä»€éº¼ï¼Ÿ

|åç¨±|å®šç¾©|
|---|---|
|Authenticationï¼ˆé©—è­‰ï¼‰|ç¢ºèªä½ æ˜¯èª°ï¼ˆä¾‹å¦‚ä½¿ç”¨å¸³å¯†ç™»å…¥ï¼Œé©—è­‰ä½ çš„èº«ä»½ï¼‰|
|Authorizationï¼ˆæˆæ¬Šï¼‰|ç¢ºèªä½ èƒ½åšä»€éº¼ï¼ˆä¾‹å¦‚æ˜¯å¦æœ‰æ¬Šé™é€²å…¥ç‰¹å®šé é¢ã€åŸ·è¡ŒæŸæ“ä½œï¼‰|

---
## 2ï¸âƒ£ JWT é©—è­‰æ©Ÿåˆ¶æµç¨‹

å‰ç«¯ Angular é€šå¸¸æœƒé€é JWTï¼ˆJSON Web Tokenï¼‰èˆ‡å¾Œç«¯äº¤äº’å®Œæˆç™»å…¥æµç¨‹ï¼š

1. ä½¿ç”¨è€…è¼¸å…¥å¸³å¯†ï¼Œç™¼é€ç™»å…¥è«‹æ±‚

2. å¾Œç«¯é©—è­‰æˆåŠŸï¼Œå›å‚³ä¸€å€‹åŠ å¯†çš„ Token

3. å‰ç«¯å„²å­˜ Tokenï¼ˆé€šå¸¸å­˜æ–¼ `localStorage` æˆ– `sessionStorage`ï¼‰

4. å¾ŒçºŒ API è«‹æ±‚éƒ½å¤¾å¸¶ Tokenï¼Œå¾Œç«¯é©—è­‰åˆæ³•æ€§

---

## 3ï¸âƒ£ å¯¦ä½œï¼šå»ºç«‹ AuthService

ğŸ“ `auth.service.ts`

```typescript
@Injectable({ providedIn: 'root' })
export class AuthService {
  private tokenKey = 'authToken';

  constructor(private http: HttpClient) {}

  login(credentials: { email: string; password: string }): Observable<any> {
    return this.http.post('/api/login', credentials).pipe(
      tap((res: any) => {
        localStorage.setItem(this.tokenKey, res.token);
      })
    );
  }

  logout() {
    localStorage.removeItem(this.tokenKey);
  }

  isLoggedIn(): boolean {
    return !!localStorage.getItem(this.tokenKey);
  }

  getToken(): string | null {
    return localStorage.getItem(this.tokenKey);
  }
}
```

---
## 4ï¸âƒ£ å»ºç«‹ AuthGuard æ§åˆ¶è·¯ç”±å­˜å–

ğŸ“ `auth.guard.ts`

```typescript
@Injectable({ providedIn: 'root' })
export class AuthGuard implements CanActivate {
  constructor(private auth: AuthService, private router: Router) {}

  canActivate(): boolean {
    if (this.auth.isLoggedIn()) {
      return true;
    }
    this.router.navigate(['/login']);
    return false;
  }
}
```

ğŸ“ `app-routing.module.ts` ä¸­åŠ ä¸Šï¼š

```typescript
{ path: 'dashboard', component: DashboardComponent, canActivate: [AuthGuard] }
```

---
## 5ï¸âƒ£ å»ºç«‹ HTTP æ””æˆªå™¨ï¼Œè‡ªå‹•åŠ å…¥ JWT Token

ğŸ“ `auth.interceptor.ts`

```typescript
@Injectable()
export class AuthInterceptor implements HttpInterceptor {
  constructor(private auth: AuthService) {}

  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {
    const token = this.auth.getToken();
    if (token) {
      const authReq = req.clone({
        setHeaders: { Authorization: `Bearer ${token}` }
      });
      return next.handle(authReq);
    }
    return next.handle(req);
  }
}
```

ä¸¦åœ¨ `app.module.ts` è¨»å†Šï¼š

```typescript
{
  provide: HTTP_INTERCEPTORS,
  useClass: AuthInterceptor,
  multi: true
}
```

---
## 6ï¸âƒ£ æ¬Šé™æˆæ¬Šç°¡å–®æ‡‰ç”¨

å¯åœ¨ä»‹é¢ä¸­é€éè‡ªå®šç¾©çš„æŒ‡ä»¤æˆ–æ¢ä»¶åˆ¤æ–·éš±è— UIï¼š

```typescript
<button *ngIf="isAdmin">åˆªé™¤è³‡æ–™</button>
```

æˆ–é…åˆå¾Œç«¯è§’è‰²æ¬Šé™æ§åˆ¶ API è¨ªå•ã€‚

---
## 7ï¸âƒ£ å®‰å…¨æ€§å»ºè­°

- â— ä¸å»ºè­°æŠŠæ•æ„Ÿè³‡æ–™ï¼ˆå¦‚ä½¿ç”¨è€…è³‡è¨Šï¼‰ç›´æ¥å­˜åœ¨ localStorage

- âœ… å¯åœ¨ JWT ä¸­åªå­˜åŸºæœ¬è³‡è¨Šï¼Œæ•æ„Ÿè³‡æ–™æ‡‰å¦é€é API æŸ¥è©¢

- âœ… è«‹æ±‚ Token æ™‚æ­é… HTTPSï¼Œé¿å…ä¸­é–“äººæ”»æ“Š

- âœ… å‰ç«¯æ¯æ¬¡é–‹å•Ÿéƒ½æ‡‰é©—è­‰ Token æ˜¯å¦éæœŸï¼ˆå¯è§£æ Token æª¢æŸ¥ `exp`ï¼‰

---

## âœ… å°çµ

- Angular ä¸­èº«ä»½é©—è­‰ä¸»è¦é  JWT å¯¦ç¾ç™»å…¥èˆ‡æŒçºŒé©—è­‰

- å¯é€é Guard æ§åˆ¶ç‰¹å®šè·¯ç”±æ˜¯å¦å…è¨±è¨ªå•

- æ””æˆªå™¨å¯å…¨è‡ªå‹•åœ°åŠ å…¥ Tokenï¼Œæé«˜ç¶­è­·æ•ˆç‡

- æ¬Šé™æˆæ¬Šå¯ä¾éœ€æ±‚åŠ å…¥è§’è‰²ç®¡ç†èˆ‡ UI æ§åˆ¶

---

## ğŸ”— å»¶ä¼¸é–±è®€

- [[015.5-Angular-è·¯ç”±èˆ‡å°èˆªç®¡ç†]]
- [[015.10-Angular-æœ€ä½³å¯¦å‹™èˆ‡æ•ˆèƒ½å„ªåŒ–]]
- [[012-RESTfulAPI-ç¸½è¦½]]
- [JWT å®˜æ–¹ä»‹ç´¹](https://jwt.io/)