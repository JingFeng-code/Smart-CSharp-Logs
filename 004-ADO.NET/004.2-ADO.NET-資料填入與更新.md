---
title: ğŸ“ ADO.NET - è³‡æ–™å¡«å…¥èˆ‡æ›´æ–°
tags:
  - ADO-NET
  - è³‡æ–™æ›´æ–°
  - è³‡æ–™å¡«å…¥
  - DataSet
  - DataAdapter
  - CSharp
  - SQL
aliases:
  - ADO.NETå¡«è³‡æ–™
  - ADO.NETæ›´æ–°è³‡æ–™
created: 2025-06-23
updated: 2025-06-23
status: å®Œæˆ
summary: ä»‹ç´¹ä½¿ç”¨ ADO.NET ä¸­çš„ DataAdapterã€DataSet é€²è¡Œè³‡æ–™å¡«å…¥èˆ‡æ›´æ–°çš„æ“ä½œæ–¹å¼èˆ‡æ³¨æ„äº‹é …ã€‚
---

# ğŸ“ ADO.NET - è³‡æ–™å¡«å…¥èˆ‡æ›´æ–°

ç•¶éœ€è¦èˆ‡è³‡æ–™åº«é€²è¡Œ **é›¢ç·šæ“ä½œï¼ˆDisconnectedï¼‰** æ™‚ï¼Œå¯ä½¿ç”¨ `DataSet` æ­é… `SqlDataAdapter` å®Œæˆè³‡æ–™çš„å–å¾—èˆ‡æ›´æ–°ã€‚

---

## 1ï¸âƒ£ ä½¿ç”¨ DataAdapter å°‡è³‡æ–™å¡«å…¥ DataSet

```csharp
string connStr = "Data Source=.;Initial Catalog=MyDatabase;Integrated Security=True;";
using(SqlConnection conn = new SqlConnection(connStr))
{
    string sql = "SELECT * FROM Members";
    SqlDataAdapter adapter = new SqlDataAdapter(sql, conn);
    DataSet ds = new DataSet();
    adapter.Fill(ds, "Members");

    // é¡¯ç¤ºè³‡æ–™
    foreach (DataRow row in ds.Tables["Members"].Rows)
    {
        Console.WriteLine(row["Name"]);
    }
}
```

### âœ… å„ªé»

- `DataSet` å¯å­˜å¤šå€‹è³‡æ–™è¡¨
- æ”¯æ´é›¢ç·šç·¨è¼¯å†ä¸€æ¬¡æ€§æ›´æ–°

---
## 2ï¸âƒ£ æ–°å¢ã€ä¿®æ”¹ã€åˆªé™¤æ“ä½œ

éœ€æ­é… `InsertCommand`ã€`UpdateCommand`ã€`DeleteCommand` è¨­å®šï¼š

```csharp
SqlCommandBuilder builder = new SqlCommandBuilder(adapter); 
adapter.Update(ds, "Members"); // æ›´æ–°å›è³‡æ–™åº«
```

æˆ–è‡ªè¨‚ SQL å‘½ä»¤ï¼š

```csharp
adapter.InsertCommand = new SqlCommand("INSERT INTO Members(Name) VALUES (@Name)", conn);
adapter.InsertCommand.Parameters.Add("@Name", SqlDbType.NVarChar, 50, "Name");
```

---
## 3ï¸âƒ£ ä½¿ç”¨ Command + ExecuteNonQuery æ›´æ–°è³‡æ–™

```csharp
string sql = "UPDATE Members SET Name = @Name WHERE Id = @Id";
SqlCommand cmd = new SqlCommand(sql, conn);
cmd.Parameters.AddWithValue("@Name", "æ–°åç¨±");
cmd.Parameters.AddWithValue("@Id", 1);
int rows = cmd.ExecuteNonQuery();
Console.WriteLine("æ›´æ–°æˆåŠŸç­†æ•¸ï¼š" + rows);
```

---
## âœ… å¸¸è¦‹æ³¨æ„äº‹é …

|é …ç›®|èªªæ˜|
|---|---|
|ä½¿ç”¨ `using` åŒ…è£é€£ç·š|è‡ªå‹•é‡‹æ”¾è³‡æº|
|ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢|é˜²æ­¢ SQL Injection|
|`DataSet` é©ç”¨å¤§é‡è³‡æ–™|å¯é›¢ç·šè™•ç†ã€é©åˆ GUI ç¶å®š|