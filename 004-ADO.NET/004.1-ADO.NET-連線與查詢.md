---
title: ğŸ”Œ ADO.NET - é€£ç·šèˆ‡æŸ¥è©¢
tags:
  - ADO-NET
  - SQL
  - è³‡æ–™åº«é€£ç·š
  - DataReader
  - CSharp
  - SQL
  - Server
aliases:
  - ADO.NETé€£ç·š
  - ADO.NETæŸ¥è©¢
  - ADO.NETåŸºæœ¬æ“ä½œ
created: 2025-06-23
updated: 2025-06-23
status: å®Œæˆ
summary: ä»‹ç´¹ ADO.NET å¦‚ä½•é€£ç·šè‡³ SQL Server è³‡æ–™åº«ä¸¦åŸ·è¡ŒåŸºæœ¬çš„ SQL æŸ¥è©¢ï¼Œæ­é… SqlConnectionã€SqlCommandã€SqlDataReaderã€‚
---

# ğŸ”Œ ADO.NET - é€£ç·šèˆ‡æŸ¥è©¢

>ADO.NET æ˜¯ .NET æä¾›çš„è³‡æ–™å­˜å–æŠ€è¡“ï¼Œä¸»è¦ç”¨æ–¼èˆ‡é—œè¯å¼è³‡æ–™åº«ï¼ˆå¦‚ SQL Serverï¼‰é€²è¡Œè³‡æ–™è®€å¯«æ“ä½œã€‚

---
## 1ï¸âƒ£ å»ºç«‹é€£ç·š `SqlConnection`

```csharp
string connStr = "Data Source=.;Initial Catalog=MyDatabase;Integrated Security=True;";
using(SqlConnection conn = new SqlConnection(connStr))
{
    conn.Open();
    // åŸ·è¡Œè³‡æ–™åº«æ“ä½œ...
}
```

|çµ„ä»¶|èªªæ˜|
|---|---|
|`Data Source`|è³‡æ–™åº«ä¼ºæœå™¨åç¨±ï¼ˆ`.` è¡¨ç¤ºæœ¬æ©Ÿï¼‰|
|`Initial Catalog`|è³‡æ–™åº«åç¨±|
|`Integrated Security`|ä½¿ç”¨ Windows é©—è­‰|

---
## 2ï¸âƒ£ åŸ·è¡ŒæŸ¥è©¢ `SqlCommand + SqlDataReader`

```csharp
string sql = "SELECT * FROM Members";
SqlCommand cmd = new SqlCommand(sql, conn);
SqlDataReader reader = cmd.ExecuteReader();
while(reader.Read())
{
    Console.WriteLine(reader["Name"].ToString());
}
reader.Close();
```

### SqlCommand èªªæ˜

|æ–¹æ³•|ç”¨é€”|
|---|---|
|`ExecuteReader()`|åŸ·è¡ŒæŸ¥è©¢ï¼ˆæŸ¥è©¢è³‡æ–™ï¼‰|
|`ExecuteNonQuery()`|åŸ·è¡Œæ›´æ–°ï¼ˆæ–°å¢/ä¿®æ”¹/åˆªé™¤ï¼‰|
|`ExecuteScalar()`|å–å¾—å–®ä¸€è³‡æ–™ï¼ˆå¦‚ COUNTï¼‰|

---
## 3ï¸âƒ£ å¸¸è¦‹ä¾‹å¤–è™•ç†

```csharp
try
{
    conn.Open();
    // ...
}
catch(SqlException ex)
{
    Console.WriteLine("è³‡æ–™åº«éŒ¯èª¤ï¼š" + ex.Message);
}
finally
{
    conn.Close();
}
```

---

## âœ… å¯¦ä½œå»ºè­°

- ä½¿ç”¨ `using` ç¢ºä¿è³‡æºæ­£ç¢ºé‡‹æ”¾
- é¿å…ç¡¬ç·¨ SQLï¼šå¾ŒçºŒå¯å­¸ç¿’åƒæ•¸åŒ–æŸ¥è©¢ä»¥é˜²æ­¢ SQL Injection
- å¯é…åˆ GUIï¼ˆå¦‚ WinFormsã€ASP.NETï¼‰æ“ä½œ UI å…ƒä»¶